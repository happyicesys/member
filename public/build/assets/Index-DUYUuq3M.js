import{r as x,T as I,f as V,l as f,V as $,h as n,a as w,w as P,F as k,o as a,b as t,j,n as M,u as N,t as d,k as c,d as p,e as U,W as C}from"./app-CIoZEdSq.js";import{A as Y}from"./AuthenticatedLayout-Byxv9JvR.js";import{_ as F}from"./_plugin-vue_export-helper-DlAUqK2U.js";/* empty css                                                                        */import"./ResponsiveNavLink-CC_ouMot.js";const H={class:"py-10 bg-gray-50"},L={class:"mx-auto max-w-3xl px-6"},E={class:"space-y-4"},O=["onClick"],T={class:"flex flex-col space-y-3 pr-4"},q={class:"text-xl font-bold text-gray-800 flex items-center space-x-2"},z={class:"text-2xl"},W={key:0,class:"bg-yellow-300 py-2 px-4 rounded-md border-2 border-red-600 text-red-600 font-bold text-md hover:bg-yellow-400"},G={class:"text-gray-600 whitespace-pre-line"},J={class:"mt-2 text-lg text-red-400 font-semibold"},K={key:0,class:"text-gray-800 text-left text-md font-medium"},Q={key:1,class:"text-gray-800 text-left text-md font-medium"},R=["onClick","disabled"],X={key:0,class:"mt-10 h-1 w-full bg-gray-300"},Z={key:1,class:"p-6 m-6 md:m-12 bg-blue-50 shadow-lg rounded-lg border border-blue-400"},ee={class:"flex items-center gap-4"},te=["src"],le={class:"text-blue-800 text-base font-medium"},se={class:"font-semibold"},oe={class:"text-gray-700 text-sm"},re={__name:"Index",props:{allPaymentMethods:Object,plans:[Array,Object],planItemUser:Object,needsPaymentMethod:Boolean,userHasAnyPaymentMethod:Boolean,userPaymentMethods:Array},setup(S){const i=S,y=x([]),_=x([]),o=x([]),g=x(!1),r=I({plan_id:""});V(()=>{y.value=i.allPaymentMethods.data,o.value=i.planItemUser.data,r.plan_id=o.value.plan_id,_.value=i.plans.data.filter(l=>l.is_available||l.id==o.value.plan_id)}),f(()=>_.value.find(l=>l.id===r.plan_id));const m=f(()=>_.value.find(l=>l.id===o.value.plan_id)),b=l=>g.value?"Processing...":m.value?l.id===m.value.id?"Subscribed":l.level>m.value.level?"Upgrade":l.level<m.value.level?"Downgrade":"Subscribe":"Subscribe",h=l=>{var e;return!l.id||l.id===((e=m.value)==null?void 0:e.id)||g.value},B=l=>{if(r.plan_id=l,!r.plan_id){alert("Please select a plan before proceeding.");return}let e=_.value.find(v=>v.id===r.plan_id);if(e.level<m.value.level){C.visit(`/plan/retention?plan_id=${r.plan_id}`);return}if(e.is_required_payment&&!i.userHasAnyPaymentMethod){C.get(`/plan/payment?plan_id=${r.plan_id}`);return}g.value=!0,r.post("/plan/subscribe",{preserveScroll:!0,onSuccess:()=>{alert("Subscription successful!"),g.value=!1,o.value.plan_id=r.plan_id},onError:v=>console.error(v)})},D=l=>{l.is_available&&(r.plan_id=l.id)},u=f(()=>i.userPaymentMethods.length>0?{...i.userPaymentMethods[0],...y.value.find(l=>l.slug==i.userPaymentMethods[0].card.display_brand)}:null);return(l,e)=>{const v=$("Head");return a(),n(k,null,[w(v,{title:"Plan"}),w(Y,null,{header:P(()=>e[0]||(e[0]=[t("h2",{class:"text-xl font-semibold leading-tight text-gray-800"}," Plan ",-1)])),default:P(()=>[t("div",H,[t("div",L,[e[10]||(e[10]=t("h2",{class:"text-3xl font-bold text-red-400 mb-6 font-heading text-center"},"Choose Your Plan",-1)),t("div",null,[t("div",E,[(a(!0),n(k,null,j(_.value,s=>(a(),n("div",{key:s.id,class:M(["p-6 bg-white rounded-lg shadow-md flex flex-col md:flex-row items-center justify-between border-2 cursor-pointer transition duration-200",N(r).plan_id===s.id?"border-red-400 bg-red-50":"border-gray-200",s.is_available?"":"opacity-50 cursor-not-allowed"]),onClick:A=>D(s)},[t("div",T,[t("h3",q,[t("div",z,d(s.name),1),o.value.plan_id===s.id?(a(),n("span",W," Current ")):c("",!0)]),t("p",G,d(s.description),1),t("p",J,d(s.price>0?`$${s.price.toFixed(2)} per month`:"Free"),1),o.value.plan_id===s.id&&!o.value.scheduled_downgrade_plan_id?(a(),n("span",K,[e[1]||(e[1]=p(" **Your plan will be renewed on ")),t("strong",null,d(o.value.date_to),1)])):c("",!0),o.value.plan_id===s.id&&o.value.scheduled_downgrade_plan_id?(a(),n("span",Q,[e[2]||(e[2]=p(" **Your plan will be expired on ")),t("strong",null,d(o.value.date_to),1),e[3]||(e[3]=p(". ")),e[4]||(e[4]=t("br",null,null,-1)),e[5]||(e[5]=p(" You will be downgraded to the ")),t("strong",null,d(o.value.scheduledDowngradePlan.name),1),e[6]||(e[6]=p(" plan. "))])):c("",!0)]),o.value.scheduled_downgrade_plan_id!==s.id?(a(),n("button",{key:0,onClick:U(A=>B(s.id),["stop"]),class:M(["font-bold mt-8 md:mt-1 py-3 px-6 rounded-lg shadow-md transition duration-200",{"bg-green-400 hover:bg-green-500 text-white":b(s)==="Subscribe","bg-green-400 hover:bg-green-500 text-white":b(s).includes("Upgrade"),"bg-yellow-400 hover:bg-yellow-500 text-white":b(s).includes("Downgrade"),"bg-yellow-300 border-2 border-red-600 text-red-600 font-bold cursor-not-allowed":b(s)==="Subscribed","bg-gray-400 cursor-not-allowed text-white":h(s)&&b(s)!=="Subscribed"}]),disabled:h(s)},d(b(s)),11,R)):c("",!0)],10,O))),128))]),u.value?(a(),n("div",X)):c("",!0),u.value?(a(),n("div",Z,[e[8]||(e[8]=t("h3",{class:"text-lg font-semibold text-gray-800 mb-3"},"Your Default Payment Method",-1)),t("div",ee,[u.value.attachment?(a(),n("img",{key:0,src:u.value.attachment.full_url,alt:"Visa Logo",class:"w-12 h-12"},null,8,te)):c("",!0),t("p",le,[e[7]||(e[7]=p(" ending in ")),t("span",se,d(u.value.card.last4),1)]),t("p",oe,"Exp: "+d(u.value.card.exp_month)+"/"+d(u.value.card.exp_year),1)]),e[9]||(e[9]=t("div",{class:"mt-4 text-center"},[t("a",{href:"/billing",class:"text-blue-600 hover:underline text-md"}," Manage Billing ")],-1))])):c("",!0)])])])]),_:1})],64)}}},ce=F(re,[["__scopeId","data-v-241776ca"]]);export{ce as default};
