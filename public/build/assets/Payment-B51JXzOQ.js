import{X as x,r,l as h,T as w,f as P,V as S,c as k,w as E,o as c,a as I,b as e,h as v,t as n,W as B}from"./app-6Z5aGBY8.js";import{l as C}from"./index-DdqIdh_m.js";import{A as N}from"./AuthenticatedLayout-DGFBMzBc.js";import{_ as D}from"./_plugin-vue_export-helper-DlAUqK2U.js";/* empty css                                                                        */import"./ResponsiveNavLink-xgxqU0Kz.js";const F={class:"py-10 bg-gray-50"},M={class:"mx-auto max-w-3xl px-6"},V={class:"p-6 bg-white rounded-lg shadow-md border-2 border-gray-200 mb-6"},j={key:0,class:"text-center"},A={class:"text-lg font-semibold text-gray-700 pb-3"},H={class:"text-gray-600 whitespace-pre-line pb-5"},K={class:"mt-2 text-red-500 font-bold"},$={key:1,class:"text-center text-gray-500"},z={class:"p-6 bg-white rounded-lg shadow-md border-2 border-gray-200"},G={class:"mt-6 text-center"},L=["disabled"],O={__name:"Payment",props:{stripeKey:String,plans:Object,planID:String},setup(b){const p=b,g=x(),u=r(g.props.planID),s=h(()=>p.plans.data.find(o=>o.id==u.value)),f=C(p.stripeKey),l=r(null),m=r(null),d=r(null),a=r(!1),i=w({plan_id:"",payment_method:""});P(async()=>{l.value=await f;const o=l.value.elements();d.value=o.create("card",{style:{base:{fontSize:"16px",fontFamily:"Poppins, sans-serif",color:"#333"}}}),d.value.mount(m.value)});const _=async()=>{if(!s.value){alert("Please select a plan before proceeding.");return}a.value=!0;const{paymentMethod:o,error:t}=await l.value.createPaymentMethod({type:"card",card:d.value});t?(alert(t.message),a.value=!1):(i.plan_id=u.value,i.payment_method=o.id,i.post("/plan/subscribe",{preserveScroll:!0,onSuccess:()=>{alert("Payment successful! Subscription activated."),B.visit("/dashboard"),a.value=!1},onError:y=>{alert("Payment failed. Please try again."),a.value=!1}}))};return(o,t)=>{const y=S("Head");return c(),k(N,null,{default:E(()=>[I(y,{title:"Payment Setup"}),e("div",F,[e("div",M,[t[3]||(t[3]=e("h2",{class:"text-3xl font-bold text-red-400 mb-6 font-heading text-center"}," Confirm Your Subscription ",-1)),e("div",V,[s.value?(c(),v("div",j,[e("h4",A,n(s.value.name),1),e("p",H,n(s.value.description),1),e("p",K,n(s.value.price>0?`$${s.value.price.toFixed(2)} per month`:"Free"),1)])):(c(),v("div",$," No plan selected. Redirecting... "))]),e("div",z,[t[0]||(t[0]=e("p",{class:"text-gray-600 text-center mb-4"}," Enter your card details below to proceed with the payment. ",-1)),e("div",{ref_key:"cardElement",ref:m,class:"border rounded-lg p-4 bg-gray-50"},null,512),t[1]||(t[1]=e("div",{class:"flex justify-start pt-3"},[e("img",{src:"/images/powered_by_stripe_1.png",alt:"Powered by Stripe Icon",class:"w-1/4 lg:w-1/6"})],-1)),e("div",G,[e("button",{onClick:_,class:"bg-green-500 text-white font-bold py-3 px-6 rounded-lg shadow-md hover:bg-green-600 transition duration-200",disabled:a.value},n(a.value?"Processing...":"Proceed to Payment"),9,L)]),t[2]||(t[2]=e("div",{class:"mt-4 text-center"},[e("a",{href:"/plan",class:"text-gray-500 hover:text-blue-600 text-sm"},"Go back to Plan Selection")],-1))])])])]),_:1})}}},q=D(O,[["__scopeId","data-v-75100f65"]]);export{q as default};
