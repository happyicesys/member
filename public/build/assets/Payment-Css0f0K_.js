import{X as R,r as p,l as k,f as x,W as g,T as A,V as B,c as N,w as T,o as b,a as V,b as o,h as _,t as h}from"./app-Dzv-NTpE.js";import{A as W}from"./AuthenticatedLayout-CyH88RfX.js";import{_ as q}from"./_plugin-vue_export-helper-DlAUqK2U.js";/* empty css                                                                        */import"./ResponsiveNavLink-BO4ONe7y.js";var L="https://js.stripe.com/v3",D=/^https:\/\/js\.stripe\.com\/v3\/?(\?.*)?$/,P="loadStripe.setLoadParameters was called but an existing Stripe.js script already exists in the document; existing script parameters will be used",F=function(){for(var t=document.querySelectorAll('script[src^="'.concat(L,'"]')),r=0;r<t.length;r++){var n=t[r];if(D.test(n.src))return n}return null},E=function(t){var r="",n=document.createElement("script");n.src="".concat(L).concat(r);var e=document.head||document.body;if(!e)throw new Error("Expected document.body not to be null. Stripe.js requires a <body> element.");return e.appendChild(n),n},G=function(t,r){!t||!t._registerWrapper||t._registerWrapper({name:"stripe-js",version:"5.6.0",startTime:r})},d=null,m=null,v=null,M=function(t){return function(){t(new Error("Failed to load Stripe.js"))}},X=function(t,r){return function(){window.Stripe?t(window.Stripe):r(new Error("Stripe.js not available"))}},H=function(t){return d!==null?d:(d=new Promise(function(r,n){if(typeof window>"u"||typeof document>"u"){r(null);return}if(window.Stripe&&t&&console.warn(P),window.Stripe){r(window.Stripe);return}try{var e=F();if(e&&t)console.warn(P);else if(!e)e=E(t);else if(e&&v!==null&&m!==null){var l;e.removeEventListener("load",v),e.removeEventListener("error",m),(l=e.parentNode)===null||l===void 0||l.removeChild(e),e=E(t)}v=X(r,n),m=M(n),e.addEventListener("load",v),e.addEventListener("error",m)}catch(c){n(c);return}}),d.catch(function(r){return d=null,Promise.reject(r)}))},K=function(t,r,n){if(t===null)return null;var e=t.apply(void 0,r);return G(e,n),e},u,j=!1,C=function(){return u||(u=H(null).catch(function(t){return u=null,Promise.reject(t)}),u)};Promise.resolve().then(function(){return C()}).catch(function(a){j||console.warn(a)});var O=function(){for(var t=arguments.length,r=new Array(t),n=0;n<t;n++)r[n]=arguments[n];j=!0;var e=Date.now();return C().then(function(l){return K(l,r,e)})};const U={class:"py-10 bg-gray-50"},$={class:"mx-auto max-w-3xl px-6"},z={class:"p-6 bg-white rounded-lg shadow-md border-2 border-gray-200 mb-6"},Q={key:0,class:"text-center"},Y={class:"text-lg font-semibold text-gray-700 pb-3"},J={class:"text-gray-600 whitespace-pre-line pb-5"},Z={class:"mt-2 text-red-500 font-bold"},ee={key:1,class:"text-center text-gray-500"},te={class:"p-6 bg-white rounded-lg shadow-md border-2 border-gray-200"},re={__name:"Payment",props:{stripeKey:String,plans:Object,planID:String},setup(a){const t=a,r=R(),n=p(r.props.planID),e=k(()=>t.plans.data.find(i=>i.id==n.value));x(()=>{e.value||(alert("No plan selected. Redirecting to plan selection..."),g.visit("/plan")),e.value.is_required_payment||S.post("/plan/subscribe",{plan_id:n.value,preserveScroll:!0,onSuccess:()=>{alert("Subscribed successfully!"),g.visit("/dashboard")},onError:i=>console.error(i)})});const l=O(t.stripeKey),c=p(null),w=p(null),f=p(null),S=A({plan_id:n.value});x(async()=>{c.value=await l;const i=c.value.elements();f.value=i.create("card",{style:{base:{fontSize:"16px",fontFamily:"Poppins, sans-serif",color:"#333"}}}),f.value.mount(w.value)});const I=async()=>{if(!e.value){alert("Please select a plan before proceeding.");return}const{paymentMethod:i,error:s}=await c.value.createPaymentMethod({type:"card",card:f.value});s?alert(s.message):S.post("/plan/subscribe",{payment_method:i.id,plan_id:n.value,preserveScroll:!0,onSuccess:()=>{alert("Payment successful! Subscription activated."),g.visit("/dashboard")},onError:y=>{console.error(y),alert("Payment failed. Please try again.")}})};return(i,s)=>{const y=B("Head");return b(),N(W,null,{default:T(()=>[V(y,{title:"Payment Setup"}),o("div",U,[o("div",$,[s[3]||(s[3]=o("h2",{class:"text-3xl font-bold text-red-400 mb-6 font-heading text-center"}," Confirm Your Subscription ",-1)),o("div",z,[e.value?(b(),_("div",Q,[o("h4",Y,h(e.value.name),1),o("p",J,h(e.value.description),1),o("p",Z,h(e.value.price>0?`$${e.value.price.toFixed(2)} per month`:"Free"),1)])):(b(),_("div",ee," No plan selected. Redirecting... "))]),o("div",te,[s[0]||(s[0]=o("p",{class:"text-gray-600 text-center mb-4"}," Enter your card details below to proceed with the payment. ",-1)),o("div",{ref_key:"cardElement",ref:w,class:"border rounded-lg p-4 bg-gray-50"},null,512),s[1]||(s[1]=o("div",{class:"flex justify-start pt-3"},[o("img",{src:"/images/powered_by_stripe_1.png",alt:"Powered by Stripe Icon",class:"w-1/4 lg:w-1/6"})],-1)),o("div",{class:"mt-6 text-center"},[o("button",{onClick:I,class:"bg-green-500 text-white font-bold py-3 px-6 rounded-lg shadow-md hover:bg-green-600 transition duration-200"}," Proceed to Payment ")]),s[2]||(s[2]=o("div",{class:"mt-4 text-center"},[o("a",{href:"/plan",class:"text-gray-500 hover:text-blue-600 text-sm"},"Go back to Plan Selection")],-1))])])])]),_:1})}}},le=q(re,[["__scopeId","data-v-145ccba3"]]);export{le as default};
