import{r as x,k as I,f as $,l as f,W as j,h as n,a as w,w as P,F as k,o as a,b as l,i as U,n as M,u as V,t as d,j as c,d as p,e as Y,X as C}from"./app-B_wQpKoy.js";import{A as F}from"./AuthenticatedLayout-Awxa29Cr.js";import{_ as H}from"./_plugin-vue_export-helper-DlAUqK2U.js";/* empty css                                                                        */import"./ResponsiveNavLink-Dt8E71P_.js";const L={class:"py-10 bg-gray-50"},N={class:"mx-auto max-w-3xl px-6"},E={class:"space-y-4"},O=["onClick"],W={class:"flex flex-col space-y-3 pr-4"},q={class:"text-xl font-bold text-gray-800 flex items-center space-x-2"},z={class:"text-2xl"},T={key:0,class:"bg-yellow-300 py-2 px-4 rounded-md border-2 border-red-600 text-red-600 font-bold text-md hover:bg-yellow-400"},X={class:"text-gray-600 whitespace-pre-line"},G={class:"mt-2 text-lg text-red-400 font-semibold"},J={key:0,class:"text-gray-800 text-left text-md font-medium"},K={key:1,class:"text-gray-800 text-left text-md font-medium"},Q=["onClick","disabled"],R={key:0,class:"mt-10 h-1 w-full bg-gray-300"},Z={key:1,class:"p-6 m-6 md:m-12 bg-blue-50 shadow-lg rounded-lg border border-blue-400"},ee={class:"flex items-center gap-4"},te=["src"],le={class:"text-blue-800 text-base font-medium"},se={class:"font-semibold"},oe={class:"text-gray-700 text-sm"},re={__name:"Index",props:{allPaymentMethods:Object,plans:[Array,Object],planItemUser:Object,needsPaymentMethod:Boolean,userHasAnyPaymentMethod:Boolean,userPaymentMethods:Array},setup(S){const i=S,y=x([]),_=x([]),o=x([]),g=x(!1),r=I({plan_id:""});$(()=>{y.value=i.allPaymentMethods.data,o.value=i.planItemUser.data,r.plan_id=o.value.plan_id,_.value=i.plans.data.filter(s=>s.is_active||s.id==o.value.plan_id)}),f(()=>_.value.find(s=>s.id===r.plan_id));const m=f(()=>_.value.find(s=>s.id===o.value.plan_id)),b=s=>g.value?"Processing...":m.value?s.id===m.value.id?"Subscribed":s.level>m.value.level?"Upgrade":s.level<m.value.level?"Downgrade":"Subscribe":"Subscribe",h=s=>{var e;return!s.id||s.id===((e=m.value)==null?void 0:e.id)||g.value},B=s=>{if(r.plan_id=s,!r.plan_id){alert("Please select a plan before proceeding.");return}let e=_.value.find(v=>v.id===r.plan_id);if(e.level<m.value.level){C.visit(`/plan/retention?plan_id=${r.plan_id}`);return}if(e.is_required_payment&&!i.userHasAnyPaymentMethod){C.get(`/plan/payment?plan_id=${r.plan_id}`);return}g.value=!0,r.post("/plan/subscribe",{preserveScroll:!0,onSuccess:()=>{alert("Subscription successful!"),g.value=!1,o.value.plan_id=r.plan_id},onError:v=>console.error(v)})},D=s=>{s.is_available&&(r.plan_id=s.id)},u=f(()=>i.userPaymentMethods.length>0?{...i.userPaymentMethods[0],...y.value.find(s=>s.slug==i.userPaymentMethods[0].card.display_brand)}:null);return(s,e)=>{const v=j("Head");return a(),n(k,null,[w(v,{title:"Plan"}),w(F,null,{header:P(()=>e[0]||(e[0]=[l("h2",{class:"text-xl font-semibold leading-tight text-gray-800"}," Plan ",-1)])),default:P(()=>[l("div",L,[l("div",N,[e[10]||(e[10]=l("h2",{class:"text-3xl font-bold text-red-400 mb-6 font-heading text-center"},"Choose Your Plan",-1)),l("div",null,[l("div",E,[(a(!0),n(k,null,U(_.value,t=>(a(),n("div",{key:t.id,class:M(["p-6 bg-white rounded-lg shadow-md flex flex-col md:flex-row items-center justify-between border-2 cursor-pointer transition duration-200",V(r).plan_id===t.id?"border-red-400 bg-red-50":"border-gray-200",t.is_available?"":"opacity-50 cursor-not-allowed"]),onClick:A=>D(t)},[l("div",W,[l("h3",q,[l("div",z,d(t.name),1),o.value.plan_id===t.id?(a(),n("span",T," Current ")):c("",!0)]),l("p",X,d(t.description),1),l("p",G,d(t.price>0?`$${t.price.toFixed(2)} per month`:"Free"),1),o.value.plan_id===t.id&&!o.value.scheduled_downgrade_plan_id?(a(),n("span",J,[e[1]||(e[1]=p(" **Your plan will be renewed on ")),l("strong",null,d(o.value.date_to),1)])):c("",!0),o.value.plan_id===t.id&&o.value.scheduled_downgrade_plan_id?(a(),n("span",K,[e[2]||(e[2]=p(" **Your plan will be expired on ")),l("strong",null,d(o.value.date_to),1),e[3]||(e[3]=p(". ")),e[4]||(e[4]=l("br",null,null,-1)),e[5]||(e[5]=p(" You will be downgraded to the ")),l("strong",null,d(o.value.scheduledDowngradePlan.name),1),e[6]||(e[6]=p(" plan. "))])):c("",!0)]),o.value.scheduled_downgrade_plan_id!==t.id&&t.is_available?(a(),n("button",{key:0,onClick:Y(A=>B(t.id),["stop"]),class:M(["font-bold mt-8 md:mt-1 py-3 px-6 rounded-lg shadow-md transition duration-200",{"bg-green-400 hover:bg-green-500 text-white":b(t)==="Subscribe","bg-green-400 hover:bg-green-500 text-white":b(t).includes("Upgrade"),"bg-yellow-400 hover:bg-yellow-500 text-white":b(t).includes("Downgrade"),"bg-yellow-300 border-2 border-red-600 text-red-600 font-bold cursor-not-allowed":b(t)==="Subscribed","bg-gray-400 cursor-not-allowed text-white":h(t)&&b(t)!=="Subscribed"}]),disabled:h(t)},d(b(t)),11,Q)):c("",!0)],10,O))),128))]),u.value?(a(),n("div",R)):c("",!0),u.value?(a(),n("div",Z,[e[8]||(e[8]=l("h3",{class:"text-lg font-semibold text-gray-800 mb-3"},"Your Default Payment Method",-1)),l("div",ee,[u.value.attachment?(a(),n("img",{key:0,src:u.value.attachment.full_url,alt:"Visa Logo",class:"w-12 h-12"},null,8,te)):c("",!0),l("p",le,[e[7]||(e[7]=p(" ending in ")),l("span",se,d(u.value.card.last4),1)]),l("p",oe,"Exp: "+d(u.value.card.exp_month)+"/"+d(u.value.card.exp_year),1)]),e[9]||(e[9]=l("div",{class:"mt-4 text-center"},[l("a",{href:"/billing",class:"text-blue-600 hover:underline text-md"}," Manage Billing ")],-1))])):c("",!0)])])])]),_:1})],64)}}},ce=H(re,[["__scopeId","data-v-5932c4f8"]]);export{ce as default};
