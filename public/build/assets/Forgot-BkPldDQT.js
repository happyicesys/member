import{T as F,r as p,f as M,c as x,w as P,o as n,a as u,u as t,Z as U,b as o,g as R,v as q,n as f,h as d,i as N,t as m,F as C,d as _,j as g,e as S,k as A}from"./app-D1ujq9iA.js";/* empty css                                                                        */import{G as L}from"./GuestLayout-UqlGvIHd.js";import{_ as E,b as h,a as k}from"./TextInput-CoXuMgSs.js";import{P as D}from"./PrimaryButton-CEKuHMzu.js";import"./ResponsiveNavLink-Bu55hd5D.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const G=["disabled"],z=["value"],Y={key:0},Z={class:"mt-6"},H={for:"otpParts",class:"flex flex-col space-y-1 items-center mb-3"},J={class:"font-normal"},K={class:"font-light"},Q={key:0},W={class:"mt-2 grid grid-cols-6 gap-2"},X={class:"mt-6"},ee={class:"relative"},se={key:0},te={key:1},oe={class:"mt-6 flex items-center justify-end"},le={key:1,class:"flex justify-end mt-2 text-sm text-blue-500"},re={class:"mt-2 flex items-center justify-center"},ne={class:"flex flex-col md:flex-row w-full md:w-fit justify-self-center mt-2 gap-8 md:w-2/5 text-center"},ae=["disabled"],ue={class:"mt-6 flex items-center justify-end"},ve={__name:"Forgot",props:{countryOptions:Object},setup(O){const B=O,e=F({country_id:"",phone_number:"",otpParts:["","","","",""],password:""}),v=p(!1),y=p(60),i=p(!1),a=p(!0),b=p(!1),w=p([]);M(()=>{w.value=B.countryOptions.data,e.country_id=w.value.filter(r=>r.is_default)[0].id});const T=()=>{e.post(route("forget.verification"),{preserveState:!0,preserveScroll:!0,replace:!0,onSuccess:()=>{v.value=!0,i.value=!0,a.value=!1,y.value=60;const r=setInterval(()=>{y.value>0?y.value--:(clearInterval(r),i.value=!1)},1e3)}})},j=r=>{if(e.otpParts[r].length===1&&r<e.otpParts.length-1){const s=document.getElementById(`otp_${r+1}`);s&&s.focus()}else if(e.otpParts[r].length===0&&r>0){const s=document.getElementById(`otp_${r-1}`);s&&s.focus()}},I=()=>{e.post(route("reset.pin"),{onFinish:()=>e.reset("otpParts","password")})};function $(){b.value=!b.value}return(r,s)=>(n(),x(L,null,{default:P(()=>[u(t(U),{title:"Reset PIN"}),s[12]||(s[12]=o("section",{class:"text-white rounded my-2 md:w-4/6 mx-auto py-5"},[o("img",{src:"/images/icon.png",alt:"Vion Icon",class:"w-1/3 lg:w-1/6 rounded mx-auto"})],-1)),s[13]||(s[13]=o("div",{class:"text-center mb-8"},[o("h1",{class:"text-3xl font-bold text-gray-800"},"Reset Your PIN"),o("p",{class:"mt-2 text-gray-600"},"Enter your phone number to receive a one-time password (OTP) to reset your PIN.")],-1)),o("form",{onSubmit:S(I,["prevent"]),class:"space-y-4 lg:w-3/12 mx-auto mb-10 px-2"},[o("div",null,[u(E,{for:"country_id",value:"Country Code"}),R(o("select",{id:"country_id",class:f(["mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:border-indigo-500 focus:ring-indigo-500",{"bg-gray-100":!a.value,"cursor-not-allowed":!a.value}]),disabled:!a.value,"onUpdate:modelValue":s[0]||(s[0]=l=>t(e).country_id=l),required:""},[s[4]||(s[4]=o("option",{value:"",disabled:""},"Select Country",-1)),(n(!0),d(C,null,N(w.value,l=>(n(),d("option",{key:l.id,value:l.id},m(l.phone_code)+" ("+m(l.name)+") ",9,z))),128))],10,G),[[q,t(e).country_id]]),u(h,{class:"mt-2",message:t(e).errors.country_id},null,8,["message"])]),o("div",null,[u(E,{for:"phone_number",value:"Phone Number"}),u(k,{id:"phone_number",type:"text",class:f(["mt-1 block w-full border-gray-300 rounded-md shadow-sm focus:border-indigo-500 focus:ring-indigo-500",{"bg-gray-100":!a.value,"cursor-not-allowed":!a.value}]),modelValue:t(e).phone_number,"onUpdate:modelValue":s[1]||(s[1]=l=>t(e).phone_number=l),disabled:!a.value,required:"",placeholder:"Enter your phone number"},null,8,["class","modelValue","disabled"]),u(h,{class:"mt-2",message:t(e).errors.phone_number},null,8,["message"])]),v.value?(n(),d("div",Y,[s[9]||(s[9]=o("hr",{class:"mt-6"},null,-1)),o("div",Z,[o("label",H,[o("span",J," Enter 5-digits OTP sent to "+m(w.value.find(l=>l.id==t(e).country_id).phone_code)+m(t(e).phone_number),1),o("span",K,[s[5]||(s[5]=_(" (Expiring in 2 minutes")),r.nowAddTwoMinutes?(n(),d("span",Q,", ")):g("",!0),_(m(r.nowAddTwoMinutes)+") ",1)])]),o("div",W,[(n(!0),d(C,null,N(t(e).otpParts,(l,c)=>(n(),x(k,{key:c,id:"otp_"+c,class:"block w-14 text-center px-2 py-3 border rounded-md focus:ring focus:ring-indigo-500 focus:ring-opacity-50",maxlength:"1",modelValue:t(e).otpParts[c],"onUpdate:modelValue":V=>t(e).otpParts[c]=V,onInput:V=>j(c),inputmode:"numeric",type:"text",pattern:"[0-9]*",required:"",ref_for:!0,ref:"otpInputs"},null,8,["id","modelValue","onUpdate:modelValue","onInput"]))),128))]),u(h,{class:"mt-2",message:t(e).errors.passwordParts},null,8,["message"])]),o("div",X,[s[8]||(s[8]=o("label",{for:"password",class:"flex items-center space-x-2"},[o("span",null,"Password"),o("span",{class:"text-yellow-700 text-sm"},"(Choose your 6 digits PIN)")],-1)),o("div",ee,[u(k,{id:"password",type:b.value?"text":"password",class:f(["mt-1 w-full pr-10",{"bg-gray-100":!a.value,"cursor-not-allowed":!a.value}]),modelValue:t(e).password,"onUpdate:modelValue":s[2]||(s[2]=l=>t(e).password=l),onInput:s[3]||(s[3]=l=>r.onInputUpdate()),disabled:!a.value,placeholder:"Numbers Only"},null,8,["type","class","modelValue","disabled"]),o("button",{type:"button",class:"absolute inset-y-0 right-0 px-3 flex items-center text-gray-500",onClick:$},[b.value?(n(),d("span",se,s[6]||(s[6]=[o("img",{src:"/images/components/eye_close.png",alt:"hide password",class:"w-8 h-8"},null,-1)]))):(n(),d("span",te,s[7]||(s[7]=[o("img",{src:"/images/components/eye_open.png",alt:"show password",class:"w-8 h-8"},null,-1)])))])]),u(h,{class:"mt-2",message:t(e).errors.password},null,8,["message"])])])):g("",!0),o("div",oe,[v.value?g("",!0):(n(),x(D,{key:0,onClick:S(T,["prevent"]),class:f(["ms-2",{"opacity-25":!t(e).country_id||!t(e).phone_number||i.value,"cursor-not-allowed":!t(e).country_id||!t(e).phone_number||i.value}]),disabled:!t(e).country_id||!t(e).phone_number||i.value},{default:P(()=>s[10]||(s[10]=[_(" Send OTP ")])),_:1},8,["class","disabled"]))]),i.value?(n(),d("div",le," Resend SMS in "+m(y.value)+" seconds... ",1)):g("",!0),o("div",re,[o("div",ne,[v.value?(n(),d("button",{key:0,onClick:I,type:"submit",class:f(["bg-yellow-300 py-2 px-8 rounded-lg shadow-md border-2 border-red-600 text-red-600 font-extrabold text-xl hover:bg-yellow-400",{"opacity-25":!t(e).otp||t(e).passwordParts.some(l=>l===""),"cursor-not-allowed":!t(e).otp||t(e).passwordParts.some(l=>l==="")}]),disabled:!t(e).otp||t(e).passwordParts.some(l=>l==="")}," RESET PIN ",10,ae)):g("",!0)])]),o("div",ue,[u(t(A),{href:r.route("login"),class:"rounded-md text-sm text-gray-600 underline hover:text-gray-900 focus:outline-none focus:ring-2 focus:ring-indigo-500 focus:ring-offset-2"},{default:P(()=>s[11]||(s[11]=[_(" Back to Login ")])),_:1},8,["href"])])],32)]),_:1}))}};export{ve as default};
