import{o as l,h as a,b as e,r as u,k as L,f as N,l as V,a as y,u as f,w as M,F as h,m as j,i as k,n as P,j as g,d as Y,t as r,e as v}from"./app-55ivKkjh.js";import{A as $}from"./AuthenticatedLayout-DOgUeSGX.js";import{l as F}from"./index-DdqIdh_m.js";import{h as E}from"./moment-C5S46NFB.js";import{r as I}from"./XMarkIcon-BHhQbwwZ.js";/* empty css                                                                        */import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./ResponsiveNavLink-BwTENdXj.js";function O(c,d){return l(),a("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true","data-slot":"icon"},[e("path",{d:"M10.75 2.75a.75.75 0 0 0-1.5 0v8.614L6.295 8.235a.75.75 0 1 0-1.09 1.03l4.25 4.5a.75.75 0 0 0 1.09 0l4.25-4.5a.75.75 0 0 0-1.09-1.03l-2.955 3.129V2.75Z"}),e("path",{d:"M3.5 12.75a.75.75 0 0 0-1.5 0v2.5A2.75 2.75 0 0 0 4.75 18h10.5A2.75 2.75 0 0 0 18 15.25v-2.5a.75.75 0 0 0-1.5 0v2.5c0 .69-.56 1.25-1.25 1.25H4.75c-.69 0-1.25-.56-1.25-1.25v-2.5Z"})])}const z={class:"py-12"},H={class:"mx-auto max-w-7xl space-y-6 sm:px-6 lg:px-8"},K={class:"bg-white p-4 shadow sm:rounded-lg sm:p-8"},Z={key:0,class:"mt-4 space-y-4"},T=["onClick"],q={class:"flex items-center gap-4"},G=["src"],J={class:"text-blue-800 text-base font-medium"},Q={class:"font-semibold"},R={class:"text-gray-700 text-sm"},U={class:"flex items-center gap-2"},W={key:0,class:"bg-green-500 text-white text-xs px-2 py-1 rounded"},X=["onClick"],ee={key:1,class:"text-sm text-gray-500 mt-4"},te={key:2,class:"mt-4"},se={class:"bg-white p-4 shadow sm:rounded-lg sm:p-8"},oe=["disabled"],le={class:"bg-white p-4 shadow sm:rounded-lg sm:p-8"},ae={class:"-mx-4 mt-6 sm:-mx-0"},ne={class:"min-w-full divide-y divide-gray-300"},re={key:0,class:"divide-y divide-gray-200 bg-white"},de={class:"py-4 pl-4 pr-3 text-sm font-medium text-gray-900 sm:pl-0"},ie={class:"px-3 py-4 text-sm text-gray-500"},ue={class:"px-3 py-4 text-sm text-gray-600 text-center"},ce={class:"px-3 py-4 text-sm"},me={class:"py-4 pl-3 pr-4 text-right text-sm font-medium sm:pr-0"},pe=["onClick"],ye={key:1},Me={__name:"Index",props:{allPaymentMethods:Object,defaultPaymentMethod:Object,stripeKey:String,invoices:[Array,Object],userPaymentMethods:Array},setup(c){const d=c,x=u(null),b=u(null),m=u(null),n=u(null),i=u(!1),p=L({});N(async()=>{x.value=await F(d.stripeKey),b.value=x.value.elements(),m.value=b.value.create("card",{style:{base:{fontSize:"16px"}}}),m.value.mount("#card-element")});const S=async()=>{i.value=!0;const{paymentMethod:o,error:s}=await x.value.createPaymentMethod({type:"card",card:m.value});if(s){alert(s.message),i.value=!1;return}p.payment_method=o.id,p.post(route("payment-methods.store"),{preserveScroll:!0,onSuccess:()=>{i.value=!1,m.value.clear()}})},A=o=>{confirm("Are you sure to remove this payment method?")&&p.delete(route("payment-methods.destroy",o.external_method_id),{preserveScroll:!0})},C=o=>{window.open(route("billing.download-invoice",o.id),"_blank")},D=o=>E.unix(o).format("YYYY-MM-DD hh:mm a"),B=()=>{n.value&&p.put(route("payment-methods.set-default",n.value),{preserveScroll:!0,onSuccess:({props:o})=>{o.defaultPaymentMethod=n.value,n.value=null}})},_=V(()=>d.userPaymentMethods.length>0?d.userPaymentMethods.map(o=>{var s;return{...o,...(((s=d.allPaymentMethods)==null?void 0:s.data)||[]).find(({slug:t})=>t===o.card.display_brand)||{},is_default:d.defaultPaymentMethod&&d.defaultPaymentMethod.id===o.id,external_method_id:o.id}}):[]);return(o,s)=>(l(),a(h,null,[y(f(j),{title:"Billing"}),y($,null,{header:M(()=>s[0]||(s[0]=[e("h2",{class:"text-xl font-semibold leading-tight text-gray-800"}," Billing ",-1)])),default:M(()=>[e("div",z,[e("div",H,[e("div",K,[s[2]||(s[2]=e("h3",{class:"text-lg font-medium text-gray-900"},"Your Payment Methods",-1)),_.value.length?(l(),a("div",Z,[(l(!0),a(h,null,k(_.value,t=>(l(),a("div",{key:t.id,class:P(["p-4 border rounded-lg flex items-center justify-between cursor-pointer hover:bg-blue-50",{"border-red-500 border-2":n.value&&n.value.id===t.id&&!t.is_default,"border-green-500":t.is_default}]),onClick:w=>t.is_default?null:n.value=t},[e("div",q,[t.attachment?(l(),a("img",{key:0,src:t.attachment.full_url,alt:"Visa Logo",class:"w-12 h-12"},null,8,G)):g("",!0),e("div",null,[e("p",J,[s[1]||(s[1]=Y(" ending in ")),e("span",Q,r(t.card.last4),1)]),e("p",R,"Exp: "+r(t.card.exp_month)+"/"+r(t.card.exp_year),1)])]),e("div",U,[t.is_default?(l(),a("span",W,"Default")):g("",!0),e("button",{type:"button",class:"rounded-full bg-red-600 p-1.5 text-white shadow-sm hover:bg-red-500 hover:cursor-pointer focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-red-600",onClick:v(w=>A(t),["stop"])},[y(f(I),{class:"h-4 w-4","aria-hidden":"true"})],8,X)])],10,T))),128))])):(l(),a("p",ee,"No payment methods added yet.")),n.value&&!n.value.is_default?(l(),a("div",te,[e("button",{onClick:B,class:"mt-6 bg-yellow-300 py-2 px-8 rounded-lg shadow-md border-2 border-red-600 text-red-600 font-bold text-xl hover:bg-yellow-400 w-full"}," Set as Default ")])):g("",!0)]),e("div",se,[s[4]||(s[4]=e("h3",{class:"text-lg font-medium text-gray-900"},"Add Payment Method",-1)),e("form",{onSubmit:v(S,["prevent"]),class:"mt-4"},[s[3]||(s[3]=e("div",{id:"card-element",class:"border p-2 rounded w-full"},null,-1)),e("button",{type:"submit",class:"mt-10 bg-yellow-300 py-2 px-8 rounded-lg shadow-md border-2 border-red-600 text-red-600 font-bold text-xl hover:bg-yellow-400 w-full",disabled:i.value},r(i.value?"Processing...":"Add Payment Method"),9,oe)],32)]),e("div",le,[s[7]||(s[7]=e("h3",{class:"text-lg font-medium text-gray-900"},"Billing History",-1)),e("div",ae,[e("table",ne,[s[6]||(s[6]=e("thead",null,[e("tr",null,[e("th",{scope:"col",class:"py-3.5 pl-4 pr-3 text-left text-sm font-semibold text-gray-900 sm:pl-0"}," Invoice # "),e("th",{scope:"col",class:"px-3 py-3.5 text-left text-sm font-semibold text-gray-900"},"Date"),e("th",{scope:"col",class:"px-3 py-3.5 text-left text-sm font-semibold text-gray-900"},"Amount"),e("th",{scope:"col",class:"px-3 py-3.5 text-left text-sm font-semibold text-gray-900"},"Status"),e("th",{scope:"col",class:"relative py-3.5 pl-3 pr-4 sm:pr-0"},[e("span",{class:"sr-only"},"Download")])])],-1)),c.invoices.length?(l(),a("tbody",re,[(l(!0),a(h,null,k(c.invoices,t=>(l(),a("tr",{key:t.id},[e("td",de,r(t.number),1),e("td",ie,r(D(t.created)),1),e("td",ue," S$ "+r((t.amount_paid/Math.pow(10,2)).toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})),1),e("td",ce,[e("span",{class:P(["inline-flex items-center rounded-md px-2 py-1 text-xs font-medium w-fit",{"bg-green-100 text-green-700":t.status==="paid","bg-yellow-100 text-yellow-700":t.status!="paid"}])},r(t.status),3)]),e("td",me,[e("button",{type:"button",class:"rounded-full bg-indigo-600 p-1.5 text-white shadow-sm hover:bg-indigo-500 hover:cursor-pointer focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-indigo-600",onClick:v(w=>C(t),["prevent"])},[y(f(O),{class:"h-4 w-4","aria-hidden":"true"})],8,pe)])]))),128))])):(l(),a("tbody",ye,s[5]||(s[5]=[e("tr",null,[e("td",{colspan:"5",class:"py-4 text-center text-sm text-gray-500"}," No invoices found. ")],-1)])))])])])])])]),_:1})],64))}};export{Me as default};
