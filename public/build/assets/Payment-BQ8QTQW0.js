import{X as C,r as p,l as I,T as k,f as A,V as B,c as R,w as T,o as b,a as V,b as o,h as S,t as h,W}from"./app-TOAG2RaY.js";import{A as D}from"./AuthenticatedLayout-Cnj_v_2M.js";import{_ as F}from"./_plugin-vue_export-helper-DlAUqK2U.js";/* empty css                                                                        */import"./ResponsiveNavLink-CYSAQrHQ.js";var P="https://js.stripe.com/v3",G=/^https:\/\/js\.stripe\.com\/v3\/?(\?.*)?$/,x="loadStripe.setLoadParameters was called but an existing Stripe.js script already exists in the document; existing script parameters will be used",M=function(){for(var e=document.querySelectorAll('script[src^="'.concat(P,'"]')),r=0;r<e.length;r++){var n=e[r];if(G.test(n.src))return n}return null},_=function(e){var r="",n=document.createElement("script");n.src="".concat(P).concat(r);var t=document.head||document.body;if(!t)throw new Error("Expected document.body not to be null. Stripe.js requires a <body> element.");return t.appendChild(n),n},N=function(e,r){!e||!e._registerWrapper||e._registerWrapper({name:"stripe-js",version:"5.6.0",startTime:r})},c=null,m=null,f=null,q=function(e){return function(){e(new Error("Failed to load Stripe.js"))}},X=function(e,r){return function(){window.Stripe?e(window.Stripe):r(new Error("Stripe.js not available"))}},H=function(e){return c!==null?c:(c=new Promise(function(r,n){if(typeof window>"u"||typeof document>"u"){r(null);return}if(window.Stripe&&e&&console.warn(x),window.Stripe){r(window.Stripe);return}try{var t=M();if(t&&e)console.warn(x);else if(!t)t=_(e);else if(t&&f!==null&&m!==null){var i;t.removeEventListener("load",f),t.removeEventListener("error",m),(i=t.parentNode)===null||i===void 0||i.removeChild(t),t=_(e)}f=X(r,n),m=q(n),t.addEventListener("load",f),t.addEventListener("error",m)}catch(d){n(d);return}}),c.catch(function(r){return c=null,Promise.reject(r)}))},K=function(e,r,n){if(e===null)return null;var t=e.apply(void 0,r);return N(t,n),t},u,E=!1,L=function(){return u||(u=H(null).catch(function(e){return u=null,Promise.reject(e)}),u)};Promise.resolve().then(function(){return L()}).catch(function(a){E||console.warn(a)});var O=function(){for(var e=arguments.length,r=new Array(e),n=0;n<e;n++)r[n]=arguments[n];E=!0;var t=Date.now();return L().then(function(i){return K(i,r,t)})};const U={class:"py-10 bg-gray-50"},$={class:"mx-auto max-w-3xl px-6"},z={class:"p-6 bg-white rounded-lg shadow-md border-2 border-gray-200 mb-6"},Q={key:0,class:"text-center"},Y={class:"text-lg font-semibold text-gray-700 pb-3"},J={class:"text-gray-600 whitespace-pre-line pb-5"},Z={class:"mt-2 text-red-500 font-bold"},ee={key:1,class:"text-center text-gray-500"},te={class:"p-6 bg-white rounded-lg shadow-md border-2 border-gray-200"},re={__name:"Payment",props:{stripeKey:String,plans:Object,planID:String},setup(a){const e=a,r=C(),n=p(r.props.planID),t=I(()=>e.plans.data.find(l=>l.id==n.value)),i=O(e.stripeKey),d=p(null),w=p(null),v=p(null),y=k({plan_id:"",payment_method:""});A(async()=>{d.value=await i;const l=d.value.elements();v.value=l.create("card",{style:{base:{fontSize:"16px",fontFamily:"Poppins, sans-serif",color:"#333"}}}),v.value.mount(w.value)});const j=async()=>{if(!t.value){alert("Please select a plan before proceeding.");return}const{paymentMethod:l,error:s}=await d.value.createPaymentMethod({type:"card",card:v.value});s?alert(s.message):(y.plan_id=n.value,y.payment_method=l.id,y.post("/plan/subscribe",{preserveScroll:!0,onSuccess:()=>{alert("Payment successful! Subscription activated."),W.visit("/dashboard")},onError:g=>{console.error(g),alert("Payment failed. Please try again.")}}))};return(l,s)=>{const g=B("Head");return b(),R(D,null,{default:T(()=>[V(g,{title:"Payment Setup"}),o("div",U,[o("div",$,[s[3]||(s[3]=o("h2",{class:"text-3xl font-bold text-red-400 mb-6 font-heading text-center"}," Confirm Your Subscription ",-1)),o("div",z,[t.value?(b(),S("div",Q,[o("h4",Y,h(t.value.name),1),o("p",J,h(t.value.description),1),o("p",Z,h(t.value.price>0?`$${t.value.price.toFixed(2)} per month`:"Free"),1)])):(b(),S("div",ee," No plan selected. Redirecting... "))]),o("div",te,[s[0]||(s[0]=o("p",{class:"text-gray-600 text-center mb-4"}," Enter your card details below to proceed with the payment. ",-1)),o("div",{ref_key:"cardElement",ref:w,class:"border rounded-lg p-4 bg-gray-50"},null,512),s[1]||(s[1]=o("div",{class:"flex justify-start pt-3"},[o("img",{src:"/images/powered_by_stripe_1.png",alt:"Powered by Stripe Icon",class:"w-1/4 lg:w-1/6"})],-1)),o("div",{class:"mt-6 text-center"},[o("button",{onClick:j,class:"bg-green-500 text-white font-bold py-3 px-6 rounded-lg shadow-md hover:bg-green-600 transition duration-200"}," Proceed to Payment ")]),s[2]||(s[2]=o("div",{class:"mt-4 text-center"},[o("a",{href:"/plan",class:"text-gray-500 hover:text-blue-600 text-sm"},"Go back to Plan Selection")],-1))])])])]),_:1})}}},le=F(re,[["__scopeId","data-v-ebdabef6"]]);export{le as default};
