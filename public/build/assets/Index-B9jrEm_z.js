import{r as f,T as I,f as V,l as x,V as $,h as r,a as w,w as P,F as k,o as d,b as t,j,n as M,u as N,t as o,k as m,d as p,e as U,W as C}from"./app-Dm1UU3xd.js";import{A as Y}from"./AuthenticatedLayout-Cej_ZSSq.js";import{_ as F}from"./_plugin-vue_export-helper-DlAUqK2U.js";/* empty css                                                                        */import"./ResponsiveNavLink-BF1xpUt_.js";const H={class:"py-10 bg-gray-50"},L={class:"mx-auto max-w-3xl px-6"},E={class:"space-y-4"},O=["onClick"],T={class:"flex flex-col space-y-3 pr-4"},q={class:"text-xl font-bold text-gray-800 flex items-center space-x-2"},z={class:"text-2xl"},W={key:0,class:"bg-yellow-300 py-1 px-2 rounded-md border-2 border-red-600 text-red-600 font-bold text-xs hover:bg-yellow-400"},G={class:"text-gray-600 whitespace-pre-line"},J={class:"mt-2 text-lg text-red-400 font-semibold"},K={key:0,class:"text-gray-800 text-left text-sm font-medium"},Q={key:1,class:"text-gray-800 text-left text-sm font-medium"},R=["onClick","disabled"],X={key:0,class:"mt-10 h-1 w-full bg-gray-300"},Z={key:1,class:"p-6 m-6 md:m-12 bg-blue-50 shadow-lg rounded-lg border border-blue-400"},ee={class:"flex items-center gap-4"},te=["src"],se={class:"text-blue-800 text-base font-medium"},le={class:"font-semibold"},ne={class:"text-gray-700 text-sm"},ae={__name:"Index",props:{allPaymentMethods:Object,plans:[Array,Object],planItemUser:Object,needsPaymentMethod:Boolean,userHasAnyPaymentMethod:Boolean,userPaymentMethods:Array},setup(S){const i=S,y=f([]),b=f([]),n=f([]),v=f(!1),a=I({plan_id:""});V(()=>{y.value=i.allPaymentMethods.data,n.value=i.planItemUser.data,a.plan_id=n.value.plan_id,b.value=i.plans.data.filter(s=>s.is_available||s.id==n.value.plan_id)}),x(()=>b.value.find(s=>s.id===a.plan_id));const c=x(()=>b.value.find(s=>s.id===n.value.plan_id)),g=s=>v.value?"Processing...":c.value?s.id===c.value.id?"Subscribed":s.level>c.value.level?"Upgrade":s.level<c.value.level?"Downgrade":"Subscribe":"Subscribe",h=s=>{var e;return!s.id||s.id===((e=c.value)==null?void 0:e.id)||v.value},B=s=>{if(a.plan_id=s,!a.plan_id){alert("Please select a plan before proceeding.");return}let e=b.value.find(_=>_.id===a.plan_id);if(e.level<c.value.level){C.visit(`/plan/retention?plan_id=${a.plan_id}`);return}if(e.is_required_payment&&!i.userHasAnyPaymentMethod){C.get(`/plan/payment?plan_id=${a.plan_id}`);return}v.value=!0,a.post("/plan/subscribe",{preserveScroll:!0,onSuccess:()=>{alert("Subscription successful!"),v.value=!1,n.value.plan_id=a.plan_id},onError:_=>console.error(_)})},D=s=>{s.is_available&&(a.plan_id=s.id)},u=x(()=>i.userPaymentMethods.length>0?{...i.userPaymentMethods[0],...y.value.find(s=>s.slug==i.userPaymentMethods[0].card.display_brand)}:null);return(s,e)=>{const _=$("Head");return d(),r(k,null,[w(_,{title:"Plan"}),w(Y,null,{header:P(()=>e[0]||(e[0]=[t("h2",{class:"text-xl font-semibold leading-tight text-gray-800"}," Plan ",-1)])),default:P(()=>[t("div",H,[t("div",L,[e[10]||(e[10]=t("h2",{class:"text-3xl font-bold text-red-400 mb-6 font-heading text-center"},"Choose Your Plan",-1)),t("div",null,[t("div",E,[(d(!0),r(k,null,j(b.value,l=>(d(),r("div",{key:l.id,class:M(["p-6 bg-white rounded-lg shadow-md flex flex-col md:flex-row items-center justify-between border-2 cursor-pointer transition duration-200",N(a).plan_id===l.id?"border-red-400 bg-red-50":"border-gray-200",l.is_available?"":"opacity-50 cursor-not-allowed"]),onClick:A=>D(l)},[t("div",T,[t("h3",q,[t("div",z,o(l.name),1),n.value.plan_id===l.id?(d(),r("span",W," Current ")):m("",!0)]),t("p",G,o(l.description),1),t("p",J,o(l.price>0?`$${l.price.toFixed(2)} per month`:"Free"),1),n.value.plan_id===l.id&&!n.value.scheduled_downgrade_plan_id?(d(),r("span",K,[e[1]||(e[1]=p(" **Your plan will be renewed on ")),t("strong",null,o(n.value.date_to),1)])):m("",!0),n.value.plan_id===l.id&&n.value.scheduled_downgrade_plan_id?(d(),r("span",Q,[e[2]||(e[2]=p(" **Your plan will be expired on ")),t("strong",null,o(n.value.date_to),1),e[3]||(e[3]=p(". ")),e[4]||(e[4]=t("br",null,null,-1)),e[5]||(e[5]=p(" You will be downgraded to the ")),t("strong",null,o(n.value.scheduledDowngradePlan.name),1),e[6]||(e[6]=p(" plan. "))])):m("",!0)]),t("button",{onClick:U(A=>B(l.id),["stop"]),class:M(["text-white font-bold mt-8 md:mt-1 py-3 px-6 rounded-lg shadow-md transition duration-200",{"bg-green-400 hover:bg-green-500":g(l)==="Subscribe","bg-green-400 hover:bg-green-500":g(l).includes("Upgrade"),"bg-yellow-400 hover:bg-yellow-500":g(l).includes("Downgrade"),"bg-gray-400 cursor-not-allowed":h(l)}]),disabled:h(l)},o(g(l)),11,R)],10,O))),128))]),u.value?(d(),r("div",X)):m("",!0),u.value?(d(),r("div",Z,[e[8]||(e[8]=t("h3",{class:"text-lg font-semibold text-gray-800 mb-3"},"Your Default Payment Method",-1)),t("div",ee,[u.value.attachment?(d(),r("img",{key:0,src:u.value.attachment.full_url,alt:"Visa Logo",class:"w-12 h-12"},null,8,te)):m("",!0),t("p",se,[e[7]||(e[7]=p(" ending in ")),t("span",le,o(u.value.card.last4),1)]),t("p",ne,"Exp: "+o(u.value.card.exp_month)+"/"+o(u.value.card.exp_year),1)]),e[9]||(e[9]=t("div",{class:"mt-4 text-center"},[t("a",{href:"/billing",class:"text-blue-600 hover:underline text-md"}," Manage Billing ")],-1))])):m("",!0)])])])]),_:1})],64)}}},ce=F(ae,[["__scopeId","data-v-6c6fa05f"]]);export{ce as default};
