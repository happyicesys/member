import{r as f,T as I,f as V,l as m,V as j,h as r,a as w,w as P,F as M,o as d,b as t,j as N,n as k,u as U,t as o,d as v,k as _,W as C}from"./app-BUtVgw7V.js";import{A as Y}from"./AuthenticatedLayout-KNI-uJSY.js";import{_ as $}from"./_plugin-vue_export-helper-DlAUqK2U.js";/* empty css                                                                        */import"./ResponsiveNavLink-D-gdUdFt.js";const F={class:"py-10 bg-gray-50"},H={class:"mx-auto max-w-3xl px-6"},L={class:"space-y-4"},E=["onClick"],O={class:"flex flex-col space-y-3 pr-4"},T={class:"text-xl font-bold text-gray-800"},q={class:"text-gray-600 whitespace-pre-line"},z={class:"mt-2 text-red-400 font-semibold"},W={key:0,class:"text-gray-800 text-right text-sm font-medium"},G={key:1,class:"text-gray-800 text-right text-sm font-medium"},J={key:0,class:"mt-10 h-1 w-full bg-gray-300"},K={key:1,class:"p-6 m-6 md:m-12 bg-blue-50 shadow-lg rounded-lg border border-blue-400"},Q={class:"flex items-center gap-4"},R=["src"],X={class:"text-blue-800 text-base font-medium"},Z={class:"font-semibold"},ee={class:"text-gray-700 text-sm"},te={class:"mt-6 text-center"},le=["disabled"],ae={__name:"Index",props:{allPaymentMethods:Object,plans:[Array,Object],planItemUser:Object,needsPaymentMethod:Boolean,userHasAnyPaymentMethod:Boolean,userPaymentMethods:Array},setup(S){const i=S,h=f([]),p=f([]),s=f([]),b=f(!1),a=I({plan_id:""});V(()=>{h.value=i.allPaymentMethods.data,p.value=i.plans.data,s.value=i.planItemUser.data,a.plan_id=s.value.plan_id});const x=m(()=>p.value.find(l=>l.id===a.plan_id)),c=m(()=>p.value.find(l=>l.id===s.value.plan_id)),g=m(()=>b.value?"Processing...":c.value?a.plan_id===c.value.id?"Subscribed":x.value.level>c.value.level?"Upgrade Plan":x.value.level<c.value.level?"Downgrade Plan":"Subscribe":"Subscribe"),y=m(()=>{var l;return!a.plan_id||a.plan_id===((l=c.value)==null?void 0:l.id)||b.value}),D=()=>{if(!a.plan_id){alert("Please select a plan before proceeding.");return}let l=p.value.find(e=>e.id===a.plan_id);if(l.level<c.value.level){C.visit(`/plan/retention?plan_id=${a.plan_id}`);return}if(l.is_required_payment&&!i.userHasAnyPaymentMethod){C.get(`/plan/payment?plan_id=${a.plan_id}`);return}b.value=!0,a.post("/plan/subscribe",{preserveScroll:!0,onSuccess:()=>{alert("Subscription successful!"),b.value=!1,s.value.plan_id=a.plan_id},onError:e=>console.error(e)})},B=l=>{l.is_available&&(a.plan_id=l.id)},u=m(()=>i.userPaymentMethods.length>0?{...i.userPaymentMethods[0],...h.value.find(l=>l.slug==i.userPaymentMethods[0].card.display_brand)}:null);return(l,e)=>{const A=j("Head");return d(),r(M,null,[w(A,{title:"Plan"}),w(Y,null,{header:P(()=>e[0]||(e[0]=[t("h2",{class:"text-xl font-semibold leading-tight text-gray-800"}," Plan ",-1)])),default:P(()=>[t("div",F,[t("div",H,[e[8]||(e[8]=t("h2",{class:"text-3xl font-bold text-red-400 mb-6 font-heading text-center"},"Choose Your Plan",-1)),t("div",null,[t("div",L,[(d(!0),r(M,null,N(p.value,n=>(d(),r("div",{key:n.id,class:k(["p-6 bg-white rounded-lg shadow-md flex items-center justify-between border-2 cursor-pointer transition duration-200",U(a).plan_id===n.id?"border-red-400 bg-red-50":"border-gray-200",n.is_available?"":"opacity-50 cursor-not-allowed"]),onClick:se=>B(n)},[t("div",O,[t("h3",T,o(n.name),1),t("p",q,o(n.description),1),t("p",z,o(n.price>0?`$${n.price.toFixed(2)} per month`:"Free"),1),s.value.plan_id===n.id&&!s.value.scheduled_downgrade_plan_id?(d(),r("span",W,[e[1]||(e[1]=v(" **Your plan will be renewed on ")),t("strong",null,o(s.value.date_to),1)])):_("",!0),s.value.plan_id===n.id&&s.value.scheduled_downgrade_plan_id?(d(),r("span",G,[e[2]||(e[2]=v(" **Your plan will be expired on ")),t("strong",null,o(s.value.date_to),1),e[3]||(e[3]=v(". You will be downgraded to the ")),t("strong",null,o(s.value.scheduledDowngradePlan.name),1),e[4]||(e[4]=v(" plan. "))])):_("",!0)])],10,E))),128))]),u.value?(d(),r("div",J)):_("",!0),u.value?(d(),r("div",K,[e[6]||(e[6]=t("h3",{class:"text-lg font-semibold text-gray-800 mb-3"},"Your Default Payment Method",-1)),t("div",Q,[u.value.attachment?(d(),r("img",{key:0,src:u.value.attachment.full_url,alt:"Visa Logo",class:"w-12 h-12"},null,8,R)):_("",!0),t("p",X,[e[5]||(e[5]=v(" ending in ")),t("span",Z,o(u.value.card.last4),1)]),t("p",ee,"Exp: "+o(u.value.card.exp_month)+"/"+o(u.value.card.exp_year),1)]),e[7]||(e[7]=t("div",{class:"mt-4 text-center"},[t("a",{href:"/billing",class:"text-blue-600 hover:underline text-md"}," Manage Billing ")],-1))])):_("",!0),t("div",te,[t("button",{onClick:D,class:k(["text-white font-bold py-3 px-6 rounded-lg shadow-md transition duration-200",{"bg-green-400 hover:bg-green-500":g.value==="Subscribe","bg-blue-400 hover:bg-blue-500":g.value.includes("Upgrade"),"bg-yellow-400 hover:bg-yellow-500":g.value.includes("Downgrade"),"bg-gray-400 cursor-not-allowed":y.value}]),disabled:y.value},o(g.value),11,le)])])])])]),_:1})],64)}}},ue=$(ae,[["__scopeId","data-v-ca58d02c"]]);export{ue as default};
